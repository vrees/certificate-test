
http:
  routers:
    frontend:
      rule: "Host(`localhost`) && PathPrefix(`/foo`)"
      service: frontend
      entryPoints:
        - "web"
      middlewares:
        - "redirectregex-frontend"
    backend:
      rule: "Host(`localhost`) && PathPrefix(`/api`)"
      service: backend
      entryPoints:
        - "web"
      middlewares:
        - "redirectregex-backend"
    esb:
      rule: "Host(`localhost`) && PathPrefix(`/api-esb`)"
      service: esb
      entryPoints:
        - "web"
      middlewares:
        - "redirectregex-esb"

  services:
    frontend:
      loadBalancer:
        servers:
          - url: http://127.0.0.1:3005
#          - url: http://myhost:3005/
    backend:
      loadBalancer:
        servers:
          - url: http://localhost:8081/
    esb:
      loadBalancer:
        servers:
          - url: srvscs1-test.atupri.ch

  middlewares:
    redirectregex-frontend:
      redirectregex:
        regex: "^http://localhost/foo"
        replacement: "http://localhost:3005"
    redirectregex-backend:
      redirectregex:
        regex: "^http://localhost/api"
        replacement: "http://localhost:8081"
    redirectregex-esb:
      redirectregex:
        regex: "^http://localhost/api-esb"
        replacement: "https://srvscs1-test.atupri.ch:9960"

